# Naive yet simple variable length, block cipher.

## Masher1 algorithm:

Very dumb, very simple "pre-shared secret" algorithm:

1. First, we will XOR data (size of which must be smaller than size of the block) with your PSK key. First byte of data will be xor-ed with first number of the key, second with second and so on rotatig cyclically through the key.
2. Then, we have to create a block of data, prefixed with the 8 bytes "long" length of the actual data size. Then we pad 8 bytes length + XOR-ed data with random bytes up to the size of the block.
3. Next, we "plant the forest", means we mixing our block with equal size of the random data in the way: {byte from original buffer}{random byte}... As you see, our result always will be twice large than the size of the buffer.
4. And finally, we "mashing" our original data with the "garbage" data. The process of "mashing" looks like this: We are going through our PSK key number by number and if the number is k % 2 == 0, we cyclically rotate all buffer N times right where the N is the value of the key element. Otherwise, we are rotating N times left. For example, for our key [1,2,3,4,5]
We will rotate 1 bit left, then 2 bits right, then 3 bits left, then 4 bits right, then 5 bits left.

## Use of the module

1. Create PSK object for generation of the pre-shared key

```python
psk = PSK(True)
key = psk.generate(64)
```
If you are passing True to the constructor, we will be using "internal" random number generator. Don't use it, unless you are doing testing. It is not cryptographically strong. Pass the number to .generate() indicating the size of the key in *bytes*.

2. Create the block for the encryption/decryption:

```python
b = MASHER_BLOCK(20, True)
```

first parameter: size of the block
second parameter is to use "internal random number generator" True = Yes, False = use sample quantumrandom generator

3. Encrypt:

```python
out = b.crypt(msg,key)
```
First parameter is your secret data
Second - psk key generated by PSK()

4. Decrypt:

```python
msg = b.decrypt(data,key)
```
